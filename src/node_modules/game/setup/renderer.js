import * as pixi from 'pixi.js';
import * as resources from 'game/resources';

const RENDERER_OPTIONS = {};
const RESIZE_MS = 1000 * 0.25;

export default () => {
  return new Promise((resolve, _reject) => {

    const renderer = pixi.autoDetectRenderer(1, 1, RENDERER_OPTIONS);
    window.r = renderer;
    resources.setRenderer(renderer);
    const view = renderer.view;
    document.body.appendChild(view);

    const resizeView = () => {
      renderer.resize(window.innerWidth, window.innerHeight);
    };

    resizeView();

    let resizeTimeout = null;
    window.addEventListener('resize', () => {
      if (resizeTimeout !== null) {
        window.clearTimeout(resizeTimeout);
      }
      resizeTimeout = window.setTimeout(resizeView, RESIZE_MS);
    });

    resolve();

  });
};
